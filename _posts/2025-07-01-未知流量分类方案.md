## 模型的泛化

泛化性（Generalization）和泛化能力，指的是模型在未见过的新数据（即训练集之外的数据）上的表现能力。简单说，泛化性/泛化能力就是“模型对新情况的适应能力”。
- 泛化性：描述模型对新样本的适应能力。一个模型不仅要在训练数据上表现好，更要能正确处理没见过的、真实环境中的数据。
- 泛化能力：是指模型将从训练数据中学到的规律应用到未知数据上的能力。泛化能力强的模型，在测试集或实际应用中也能保持较高的准确率，不容易过拟合。

## 模型对未知类的分类

大模型在加密流量分类任务上存在泛化性，当下的任务则需要进一步验证大模型对加密流量未知类的泛化能力，输出模型在未知类别上的分类效果。

## 方案设计

### 方案总体介绍

针对加密流量未知类的识别，需要先分类，后聚类。在这个基础上提出了两种方案：  

#### 第一种方案：置信度阈值（分类） + HDBSCAN（聚类）

```
+-------输入--------+
|加密流量数据        |
+-------------------+
         ↓
+------------------第一阶段（筛选未知类）-------------------+
|编码器（深度学习模型提取特征向量化）                         |
|                 ↓                                      | 
|置信度阈值 (分出已知流量和未知流量，未知流量则进入下一阶段)    |
+--------------------------------------------------------+
                       ↓
                       ↓第一阶段分出的未知类别
                       ↓
+------------------第二阶段（细分未知类）-------------------+
|HDBSCAN (对未知类别进行细分)                              |
+--------------------------------------------------------+
                     ↓  
+-------------------输出------------------+
|未知类1，未知类2，......，未知类某某        |
+-----------------------------------------+
```

#### 第二种方案：Openmax（分类） + HDBSCAN（聚类）  

```
+-------输入--------+
|加密流量数据        |
+-------------------+
         ↓
+------------------第一阶段（筛选未知类）-------------------+
|编码器（深度学习模型提取特征向量化）                         |
|                 ↓                                      | 
|Openmax (分出已知流量和未知流量，未知流量则进入下一阶段)      |
+--------------------------------------------------------+
                       ↓
                       ↓第一阶段分出的未知类别
                       ↓
+------------------第二阶段（细分未知类）-------------------+
|HDBSCAN (对未知类别进行细分)                              |
+--------------------------------------------------------+
                     ↓  
+-------------------输出------------------+
|未知类1，未知类2，......，未知类某某        |
+-----------------------------------------+
```

#### 两种方案的异和同

两种方案都分为“筛选未知类”和“未知类细分”两个阶段，先用置信度或Openmax方法将未知流量整体分离，再用HDBSCAN对未知类进一步细分。也就是说区别只在第一阶段。

```
+-------输入--------+
|加密流量数据        |
+-------------------+
         ↓
+--------------------第一阶段（筛选未知类）---------------------+
|编码器（深度学习模型提取特征向量化）                             |
|                 ↓                                          | 
|置信度阈值/Openmax (分出已知流量和未知流量，未知流量则进入下一阶段)|
+------------------------------------------------------------+
                       ↓
                       ↓第一阶段分出的未知类别
                       ↓
+------------------第二阶段（细分未知类）-------------------+
|HDBSCAN (对未知类别进行细分)                              |
+--------------------------------------------------------+
                     ↓  
+-------------------输出------------------+
|未知类1，未知类2，......，未知类某某        |
+-----------------------------------------+
```

### 置信度阈值（分类）
- 置信度阈值：通过模型输出的Softmax概率，若最大概率低于阈值，则判为未知类，否则为已知类。
- HDBSCAN：对置信度样本进行无监督聚类，实现未知类的自动细分。HDBSCAN相比DBSCAN更适合高维、密度变化大的数据，能更好识别复杂结构。

### Openmax（分类）
- Openmax：基于深度神经网络输出的激活向量，统计每类的均值向量（MAV），计算样本与MAV的距离，并用Weibull分布建模，判断是否为未知类。
- HDBSCAN：同上，对Openmax筛选出的未知类再聚类细分。

### HDBSCAN（聚类）

### 算法流程
- 特征提取 → 降维（如UMAP）→ 构建可达距离图 → 聚类（HDBSCAN）→ 结构优化。
- Openmax还包括Softmax概率调整、未知类概率计算和归一化处理。

## 总结
- 两种方案都能有效识别加密流量中的未知类别，并对未知类进行细分。
- HDBSCAN适合高维、复杂、密度变化大的数据，聚类效果优于传统方法。
- Openmax能进一步提升未知类识别的准确性，降低已知类被误判为未知类的风险。

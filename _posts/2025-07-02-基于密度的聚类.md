**基于密度的聚类**是一类无监督聚类方法，核心思想是：将数据空间中密度较高的区域划分为同一类，密度较低的区域视为噪声或边界。常见代表算法有DBSCAN和HDBSCAN。

- **优点**：能发现任意形状的簇，对噪声和异常值有较好鲁棒性，不需要预先指定簇的数量。
- **典型流程**：通过设定密度阈值（如邻域半径和最小点数），将密度相连的数据点归为一类。

**DBSCAN和KMeans的区别：**

区别：

| 方面         | KMeans机制                                      | DBSCAN机制                                      |
|--------------|------------------------------------------------|------------------------------------------------|
| 聚类思想     | 基于距离的中心点分配，最小化簇内平方误差         | 基于密度，寻找密度足够高的区域形成簇             |
| 聚类形状     | 适合球状、均匀分布的簇                          | 可识别任意形状的簇                              |
| 簇数量       | 需预先指定K值（簇数）                           | 不需要指定簇数，自动发现                        |
| 噪声处理     | 不具备噪声识别能力，所有点都要归类               | 能识别噪声点（离群点）                          |
| 参数         | 主要参数为簇数K                                 | 主要参数为邻域半径ε和最小点数MinPts              |
| 对异常敏感性 | 对异常点敏感，异常点会影响聚类中心               | 对异常点鲁棒，异常点会被标记为噪声               |
| 适用场景     | 适合簇大小相近、密度均匀的数据                   | 适合簇密度不均、形状复杂、含噪声的数据           |

HDBSCAN与DBSCAN的比较：   
虽然两者都是基于密度的聚类算法，但它们在处理不同密度簇和噪声数据方面有显著差异：

| 对比项         | DBSCAN                                                         | HDBSCAN                                                         |
|----------------|---------------------------------------------------------------|-----------------------------------------------------------------|
| 参数选择       | 需要预选指定固定的密度阈值α和最小样本数k                      | 不需要固定的密度阈值，通过层次化方法自适应不同密度簇            |
| 处理不同密度簇 | 在处理不同密度簇时表现不佳，因为固定的α可能无法适应所有簇的密度 | 通过构建层次树和稳定性评分，能够有效识别不同密度的簇            |
| 噪声识别       | 只能基于固定阈值识别噪声点                                     | 利用稳定性评分和层次化信息，能够更准确地识别噪声点              |
| 输出结果       | 直接输出一个扁平的聚类结果                                     | 除了扁平聚类结果外，还提供层次树结构和每个簇的稳定性评分        |

## DBSCAN

Let’s say we have a data set of points like the following. Our goal is to cluster these points into groups that are densely packed together.

![DBSCAN]({{ "/assets/images/2025-07-02/1_dbscan.jpg" | relative_url }})

 First, we count the number of points close to each point. For example, if we start with the yellow point, we draw a circle around it. The radius $\varepsilon$ (邻域半径) of the circle is the first parameter that we have to determine when using DBSCAN.       
After drawing the circle, we count the overlaps. For example, for our yellow point, there are five close points.

![DBSCAN]({{ "/assets/images/2025-07-02/2_dbscan.jpg" | relative_url }})

Likewise, we count the number of close points for all remaining points.

![DBSCAN]({{ "/assets/images/2025-07-02/3_dbscan.jpg" | relative_url }})

Next, we will determine another parameter, the minimum number of points $\text{MinPts}$. Each point is considered a core point if they are close to at least m other points. For example, if we take m as three, then, purple points are considered as **core points** (核心点), but the yellow one is not because it doesn’t have any close points around it. Identifying four purple core points and one yellow outlier.

$$N\{O(\varepsilon)\} \geq \text{MinPts}$$

![DBSCAN]({{ "/assets/images/2025-07-02/4_dbscan.jpg" | relative_url }})

All core data points in purple.

![DBSCAN]({{ "/assets/images/2025-07-02/5_dbscan.jpg" | relative_url }})

直接密度可达（Directly Density-Reachable）的**定义**：
- 点q从点p直接密度可达，当且仅当：
  - p是核心点（其ε-邻域内至少包含MinPts个点）
  - q位于p的ε-邻域内（即d(p,q) ≤ ε）

直接密度可达的**特点**：
- 单向关系：q从p直接密度可达 ≠ p从q直接密度可达（除非q也是核心点）
- 一步直达：不需要中间点
- 示例：如果p是核心点，q在p的ε邻域内，则q从p直接密度可达

间接密度可达（Indirectly Density-Reachable）的**定义**：
- 点q从点p间接密度可达，意味着：
  - 存在一系列点p₁,p₂,...,pₙ（p₁=p，pₙ=q）
  - 每个pᵢ₊₁从pᵢ直接密度可达（i=1,2,...,n-1）
  - 且n ≥ 3（至少经过一个中间点）

间接密度可达的**特点**：
- 多跳连接：必须通过至少一个中间核心点传递
- 仍然是单向关系
- 示例：p→core₁→core₂→q（p到q通过两个核心点连接）

密度可达（Density-Reachable）的**定义**：
- 点q从点p密度可达，意味着：
  - 存在一系列点p₁,p₂,...,pₙ（p₁=p，pₙ=q）
  - 每个pᵢ₊₁从pᵢ直接密度可达
  - 链条长度n ≥ 2（允许直接或间接连接）

密度可达的**特点**：
- 包含两种情况：
  - 直接密度可达（当n=2时）
  - 间接密度可达（当n≥3时）
- 是前两个概念的超集
- 示例：
  - p→q（直接，n=2）
  - p→core₁→core₂→q（间接，n=4）

Then, we randomly select a core point and assign it as the first point in our first cluster (随机选择一个未访问的核心点作为种子). Other points that are close to this point are also assigned to the same cluster (i.e., within the circle of the selected point).

![DBSCAN]({{ "/assets/images/2025-07-02/6_dbscan.jpg" | relative_url }})

Then, we extend it to the other points that are close (簇扩展).

![DBSCAN]({{ "/assets/images/2025-07-02/7_dbscan.jpg" | relative_url }})

We stop when we can’t assign more core points to the first cluster. Some core points couldn’t be appointed even though they were close to the first cluster. We draw the circles of these points and see if the first cluster is close to the core points. If there is an overlap, we put them in the first cluster.        
However, we can’t assign any non-core points. They are considered outliers.

![DBSCAN]({{ "/assets/images/2025-07-02/8_dbscan.jpg" | relative_url }})

Now, we still have core points that aren’t assigned. We randomly select another point from them and start over.

![DBSCAN]({{ "/assets/images/2025-07-02/9_dbscan.jpg" | relative_url }})

所有既不是核心点，也不在任何核心点的ε-邻域内的点被标记为噪声/离群点。这些点不会被归入任何簇。

## HDBSCAN

### HDBSCAN简介 

HDBSCAN（Hierarchical Density-Based Spatial Clustering of Applications with Noise）是DBSCAN的改进版，属于层次化的基于密度的聚类算法。

- **主要特点**：
  - 不需要固定的密度阈值，能自适应不同密度的数据簇。
  - 通过构建密度可达的层次树结构，自动选择最优聚类结果。
  - 能更好地处理高维、复杂、密度变化大的数据。
  - 能有效识别噪声点。

- **适用场景**：高维、复杂结构、簇密度不均的数据聚类任务。

